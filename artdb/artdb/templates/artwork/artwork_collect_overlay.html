<div class="content">
    <div class="center">
        <table class="collections-list">
            <th colspan=2>
                Add or remove {{artwork.title}} to your collections:
            </th>
            {% if collections %}
                {% for collection in collections %}
                <tr>
                    <td>{{collection.title}}</td>
                    <td class="collectButtons {% if artwork in collection.artworks.all %}remove{% endif %}">
                        <button class="removeFromCollection" data-collectionid="{{collection.id}}" data-artworkid="{{artwork.id}}">remove</button>
                        <button class="addToCollection" data-collectionid="{{collection.id}}" data-artworkid="{{artwork.id}}">add</button>
                    </td>
                </tr>
                {% endfor %}
                {% else %}
                <tr>
                    <td colspan=2>You don not have any collections yet.</td>
                </tr>
            {% endif %}
            <tr>
                <td colspan=2><button class="addCollection">Add new collection</button></td>
            </tr>
        </table>

        <button name="close" class="button-close"  onClick="hideCollectOverlay()"></button>
    </div>
</div>
    
<div class="sidebar-attached">
    <aside class="inspector detail-inspector">
    </aside>
</div>

<script>
$(document).ready(function() {
    $(".removeFromCollection").on('click', function (e) {
        artworkID = e.currentTarget.dataset['artworkid'];
        collectionID = e.currentTarget.dataset['collectionid'];
        var url = '/artwork/' + artworkID + '/collect_overlay.html';
        $.ajax({
            type: 'POST',
            url: url,
            data: {
                'csrfmiddlewaretoken': '{{ csrf_token }}',
                'artwork-id': artworkID,
                'collection-id': collectionID,
                'action': 'remove'
            },
            success: function(message) {
                console.log("remove artwork from collection");
                e.currentTarget.parentElement.classList.toggle('remove');
            },
            error: function(error) {
                console.log(error);
            }
        })
    });
    $(".addToCollection").on('click', function (e) {
        artworkID = e.currentTarget.dataset['artworkid'];
        collectionID = e.currentTarget.dataset['collectionid'];
        var url = '/artwork/' + artworkID + '/collect_overlay.html';
        $.ajax({
            type: 'POST',
            url: url,
            data: {
                'csrfmiddlewaretoken': '{{ csrf_token }}',
                'artwork-id': artworkID,
                'collection-id': collectionID,
                'action': 'add'
            },
            success: function(message) {
                console.log("added artwork to collection");
                e.currentTarget.parentElement.classList.toggle('remove');
            },
            error: function(error) {
                console.log(error);
            }
        })
    });
});
</script>
